[Powered by Devin](https://devin.ai/)

[DeepWiki](https://deepwiki.com/)

[return to regenrek/deepwiki-mcp](https://deepwiki.com/regenrek/deepwiki-mcp)

MCPサーバーのセットアップ方法を教えてください

Fast

Searched across regenrek/deepwiki-mcp

## Answer

MCPサーバーのセットアップ方法について説明します。このリポジトリ（regenrek/deepwiki-mcp）は、deepwiki.comからコンテンツを取得し、マークダウン形式に変換するMCPサーバーです。

## セットアップ方法

### 1\. インストール方法

#### NPXを使用する方法（推奨）

MCPサーバーを設定ファイルに追加します：

```
{  
  "mcpServers": {  
    "mcp-deepwiki": {  
      "command": "npx",  
      "args": ["-y", "mcp-deepwiki"]  
    }  
  }  
}
```

README.md:18-25

#### ソースコードからインストールする方法

```
# リポジトリをクローン  
git clone https://github.com/regenrek/mcp-deepwiki.git  
cd mcp-deepwiki  
  
# 依存関係をインストール  
npm install  
  
# パッケージをビルド  
npm run build
```

README.md:139-149

ローカル開発の場合は、以下の設定を使用します：

```
{  
  "mcpServers": {  
    "mcp-deepwiki": {  
      "command": "node",  
      "args": ["./bin/cli.mjs"]  
    }  
  }  
}
```

README.md:126-135

### 2\. 使用方法

MCPサーバーは、 `deepwiki_fetch` というツールを提供しています。このツールを使用して、deepwiki.comからコンテンツを取得し、マークダウン形式に変換できます。

```
{  
  "action": "deepwiki_fetch",  
  "params": {  
    "url": "https://deepwiki.com/user/repo",  
    "mode": "aggregate",  
    "maxDepth": "1"  
  }  
}
```

README.md:32-41

#### パラメータ

- `url` (必須): Deepwikiリポジトリの開始URL
- `mode` (オプション): 出力モード、単一のマークダウンドキュメントの場合は "aggregate"（デフォルト）、構造化されたページデータの場合は "pages"
- `maxDepth` (オプション): クロールするページの最大深度（デフォルト: 10） README.md:45-47

### 3\. 環境変数による設定

以下の環境変数を使用して、サーバーの動作をカスタマイズできます：

- `DEEPWIKI_MAX_CONCURRENCY`: 最大同時リクエスト数（デフォルト: 5）
- `DEEPWIKI_REQUEST_TIMEOUT`: リクエストタイムアウト（ミリ秒、デフォルト: 30000）
- `DEEPWIKI_MAX_RETRIES`: 失敗したリクエストの最大再試行回数（デフォルト: 3）
- `DEEPWIKI_RETRY_DELAY`: 再試行のベース遅延（ミリ秒、デフォルト: 250） README.md:172-175

これらの設定を行うには、プロジェクトのルートに`.env` ファイルを作成します：

```
DEEPWIKI_MAX_CONCURRENCY=10  
DEEPWIKI_REQUEST_TIMEOUT=60000  
DEEPWIKI_MAX_RETRIES=5  
DEEPWIKI_RETRY_DELAY=500
```

README.md:179-184

### 4\. Dockerを使用したデプロイ（未テスト）

```
# イメージをビルド  
docker build -t mcp-deepwiki .  
  
# stdio転送を使用して実行（開発用）  
docker run -it --rm mcp-deepwiki  
  
# HTTP転送を使用して実行（本番用）  
docker run -d -p 3000:3000 mcp-deepwiki --http --port 3000  
  
# 環境変数を使用して実行  
docker run -d -p 3000:3000 \  
  -e DEEPWIKI_MAX_CONCURRENCY=10 \  
  -e DEEPWIKI_REQUEST_TIMEOUT=60000 \  
  mcp-deepwiki --http --port 3000
```

README.md:190-205

### 5\. 開発モードでの実行

```
# 依存関係をインストール  
pnpm install  
  
# stdioを使用して開発モードで実行  
pnpm run dev-stdio  
  
# テストを実行  
pnpm test  
  
# リンターを実行  
pnpm run lint  
  
# パッケージをビルド  
pnpm run build
```

README.md:209-224

## トラブルシューティング

一般的な問題と解決策：

1. **権限拒否（Permission Denied）**: CLIの実行時にEACCESエラーが発生した場合は、バイナリに実行権限を付与してください：
	```
	chmod +x ./node_modules/.bin/mcp-deepwiki
	```
2. **接続拒否（Connection Refused）**: ポートが利用可能で、ファイアウォールにブロックされていないことを確認してください：
	```
	# ポートが使用中かどうかを確認  
	lsof -i :3000
	```
3. **タイムアウトエラー**: 大きなリポジトリの場合は、タイムアウトと同時実行数を増やすことを検討してください：
	```
	DEEPWIKI_REQUEST_TIMEOUT=60000 DEEPWIKI_MAX_CONCURRENCY=10 npx mcp-deepwiki
	```

README.md:228-245

## Notes

このMCPサーバーは、deepwiki.comのURLを受け取り、関連するページをクロールし、HTMLをマークダウンに変換して返すサービスです。セキュリティ上の理由から、deepwiki.comドメインのみを処理します。サーバーは、stdio、HTTP、SSEの3つの転送方式をサポートしています。

Wiki pages you might want to explore:

- [Content Processing Pipeline (regenrek/deepwiki-mcp)](https://deepwiki.com/regenrek/deepwiki-mcp/2.1-content-processing-pipeline)

[regenrek/deepwiki-mcp](https://github.com/regenrek/deepwiki-mcp) [README.md](https://github.com/regenrek/deepwiki-mcp/blob/87b256a0/README.md)

```
15
## Usage
16

17
\`\`\`
```

```
18
{
19
  "mcpServers": {
20
    "mcp-deepwiki": {
21
      "command": "npx",
22
      "args": ["-y", "mcp-deepwiki"]
23
    }
24
  }
25
}
```

```
26
\`\`\`
27

28
### MCP Tool Integration
29

30
The package registers a tool named \`deepwiki_fetch\` that you can use with any MCP-compatible client:
31
```

```
32
\`\`\`json
33
{
34
  "action": "deepwiki_fetch",
35
  "params": {
36
    "url": "https://deepwiki.com/user/repo",
37
    "mode": "aggregate",
38
    "maxDepth": "1"
39
  }
40
}
41
\`\`\`
```

```
42

43
#### Parameters
44
```

```
45
- \`url\` (required): The starting URL of the Deepwiki repository
46
- \`mode\` (optional): Output mode, either "aggregate" for a single Markdown document (default) or "pages" for structured page data
47
- \`maxDepth\` (optional): Maximum depth of pages to crawl (default: 10)
```

```
48

49
### Response Format
50
```

```
123

124
### Local Usage
125
```

```
126
\`\`\`
127
{
128
  "mcpServers": {
129
    "mcp-deepwiki": {
130
      "command": "node",
131
      "args": ["./bin/cli.mjs"]
132
    }
133
  }
134
}
135
\`\`\`
```

```
136

137
### From Source
138
```

```
139
\`\`\`bash
140
# Clone the repository
141
git clone https://github.com/regenrek/mcp-deepwiki.git
142
cd mcp-deepwiki
143

144
# Install dependencies
145
npm install
146

147
# Build the package
148
npm run build
149
\`\`\`
```

```
150

151
#### Direct API Calls
152
```

```
169

170
### Environment Variables
171
```

```
172
- \`DEEPWIKI_MAX_CONCURRENCY\`: Maximum concurrent requests (default: 5)
173
- \`DEEPWIKI_REQUEST_TIMEOUT\`: Request timeout in milliseconds (default: 30000)
174
- \`DEEPWIKI_MAX_RETRIES\`: Maximum retry attempts for failed requests (default: 3)
175
- \`DEEPWIKI_RETRY_DELAY\`: Base delay for retry backoff in milliseconds (default: 250)
```

```
176

177
To configure these, create a \`.env\` file in the project root:
178
```

```
179
\`\`\`
180
DEEPWIKI_MAX_CONCURRENCY=10
181
DEEPWIKI_REQUEST_TIMEOUT=60000
182
DEEPWIKI_MAX_RETRIES=5
183
DEEPWIKI_RETRY_DELAY=500
184
\`\`\`
```

```
185

186
## Docker Deployment (Untested)
187

188
Build and run the Docker image:
189
```

```
190
\`\`\`bash
191
# Build the image
192
docker build -t mcp-deepwiki .
193

194
# Run with stdio transport (for development)
195
docker run -it --rm mcp-deepwiki
196

197
# Run with HTTP transport (for production)
198
docker run -d -p 3000:3000 mcp-deepwiki --http --port 3000
199

200
# Run with environment variables
201
docker run -d -p 3000:3000 \
202
  -e DEEPWIKI_MAX_CONCURRENCY=10 \
203
  -e DEEPWIKI_REQUEST_TIMEOUT=60000 \
204
  mcp-deepwiki --http --port 3000
205
\`\`\`
```

```
206

207
## Development
208
```

```
209
\`\`\`bash
210
# Install dependencies
211
pnpm install
212

213
# Run in development mode with stdio
214
pnpm run dev-stdio
215

216
# Run tests
217
pnpm test
218

219
# Run linter
220
pnpm run lint
221

222
# Build the package
223
pnpm run build
224
\`\`\`
```

```
225

226
## Troubleshooting
227
```

```
228
### Common Issues
229

230
1. **Permission Denied**: If you get EACCES errors when running the CLI, make sure to make the binary executable:
231
   \`\`\`bash
232
   chmod +x ./node_modules/.bin/mcp-deepwiki
233
   \`\`\`
234

235
2. **Connection Refused**: Make sure the port is available and not blocked by a firewall:
236
   \`\`\`bash
237
   # Check if port is in use
238
   lsof -i :3000
239
   \`\`\`
240

241
3. **Timeout Errors**: For large repositories, consider increasing the timeout and concurrency:
242
   \`\`\`
243
   DEEPWIKI_REQUEST_TIMEOUT=60000 DEEPWIKI_MAX_CONCURRENCY=10 npx mcp-deepwiki
244
   \`\`\`
245
```

```
246
## Contributing
247

248
We welcome contributions! Please see [CONTRIBUTING.md](CONTRIBUTING.md) for details.
```

[return to regenrek/deepwiki-mcp](https://deepwiki.com/regenrek/deepwiki-mcp)

セットアップに失敗しています mcp-deepwiki Configure Error: failed to initialize server: npm error code EEXIST npm error syscall mkdir npm error path /Users/ayumu/.npm/\_cacache/content-v2/sha512/5d/ee npm error err...

Fast

Searched across regenrek/deepwiki-mcp

## Answer

npmのパーミッション問題によりセットアップに失敗しているようです。エラーメッセージを見ると、npmのキャッシュディレクトリに書き込み権限がないことが原因です。

## エラーの詳細

エラーメッセージから以下の問題が確認できます：

```
npm error EACCES: permission denied, mkdir '/Users/ayumu/.npm/_cacache/content-v2/sha512/5d/ee'  
npm error File exists: /Users/ayumu/.npm/_cacache/content-v2/sha512/5d/ee'
```

これは、npmがキャッシュディレクトリに書き込もうとしたときに権限エラーが発生したことを示しています。

## 解決方法

このような権限問題を解決するには、以下の方法を試してみてください：

### 1\. npmキャッシュのクリア

```
npm cache clean --force
```

### 2\. npmキャッシュディレクトリの権限修正

```
sudo chown -R $(whoami) ~/.npm
```

### 3\. --forceオプションを使用してインストール

エラーメッセージにも示されているように、 `--force` オプションを使用してインストールを試みることができます：

```
npx -y --force mcp-deepwiki
```

### 4\. グローバルインストールを避ける方法

ローカルプロジェクトにインストールする方法も試してみてください：

```
# プロジェクトディレクトリを作成  
mkdir mcp-deepwiki-project  
cd mcp-deepwiki-project  
  
# package.jsonを初期化  
npm init -y  
  
# ローカルにインストール  
npm install mcp-deepwiki  
  
# 設定ファイルを作成
```

そして、以下のような設定を使用します：

```
{  
  "mcpServers": {  
    "mcp-deepwiki": {  
      "command": "node",  
      "args": ["./node_modules/.bin/mcp-deepwiki"]  
    }  
  }  
}
```

### 5\. 代替方法：ソースからのインストール

npmのグローバルインストールに問題がある場合は、リポジトリを直接クローンして使用する方法も効果的です：

```
# リポジトリをクローン  
git clone https://github.com/regenrek/mcp-deepwiki.git  
cd mcp-deepwiki  
  
# 依存関係をインストール（--no-globalオプションを追加）  
npm install --no-global  
  
# パッケージをビルド  
npm run build
```

そして、以下の設定を使用します：

```
{  
  "mcpServers": {  
    "mcp-deepwiki": {  
      "command": "node",  
      "args": ["./bin/cli.mjs"]  
    }  
  }  
}
```

README.md:126-135

## トラブルシューティングのヒント

READMEのトラブルシューティングセクションにも記載されているように、権限の問題は一般的です：

```
# バイナリに実行権限を付与  
chmod +x ./node_modules/.bin/mcp-deepwiki
```

README.md:230-233

これらの方法を試してみて、問題が解決しない場合は、npmの設定やシステムの権限設定を確認する必要があるかもしれません。

## Notes

このエラーはnpmのキャッシュディレクトリへの書き込み権限の問題です。macOSでは、特に以前に `sudo` でnpmコマンドを実行したことがある場合に発生しやすい問題です。解決策は主に権限の修正とキャッシュのクリアに焦点を当てています。

Wiki pages you might want to explore:

- [API Reference (regenrek/deepwiki-mcp)](https://deepwiki.com/regenrek/deepwiki-mcp/3-api-reference)

Fast

Searched across regenrek/deepwiki-mcp

## Answer

いいえ、このコマンドの実行結果は正常ではありません。エラーが発生しています。

## エラーの分析

実行結果を見ると、npmキャッシュのクリーニングを試みましたが、権限エラー（EACCES）が発生しています。エラーメッセージには以下の重要な情報が含まれています：

1. キャッシュフォルダに root 所有のファイルが含まれている
2. これは以前のバージョンのnpmのバグが原因
3. 問題を永続的に修正するための推奨コマンドが提示されている

## 推奨される解決策

エラーメッセージ自体が解決策を提案しています：

```
sudo chown -R 502:20 "/Users/ayumu/.npm"
```

このコマンドは、npmのキャッシュディレクトリの所有権をあなたのユーザー（ID: 502）とグループ（ID: 20）に変更します。これにより、npmがキャッシュディレクトリに書き込む権限を持つようになります。

## 実行手順

1. エラーメッセージに表示されている通りに、以下のコマンドを実行してください：
	```
	sudo chown -R 502:20 "/Users/ayumu/.npm"
	```
2. パスワードを入力すると、コマンドが実行されます。
3. その後、再度キャッシュのクリーニングを試みてください：
	```
	npm cache clean --force
	```
4. キャッシュがクリーンになったら、元のMCPサーバーのセットアップを再試行してください。

## 注意点

- `sudo` コマンドは管理者権限でコマンドを実行するため、パスワードの入力が必要です。
- ユーザーIDとグループIDは環境によって異なる場合があります。エラーメッセージに表示されている値（502:20）を使用してください。
- このコマンドを実行すると、npmのキャッシュディレクトリの所有権が変更されますが、他のシステムファイルには影響しません。

このエラーは、以前に `sudo` を使用してnpmコマンドを実行したことがある場合によく発生します。上記の解決策を実行することで、キャッシュディレクトリの権限問題が解決され、MCPサーバーのセットアップを続行できるようになるはずです。

## Notes

このエラーはnpmのキャッシュディレクトリの権限問題です。macOSでは、特に以前に `sudo` でnpmコマンドを実行したことがある場合に発生しやすい問題です。エラーメッセージに表示されている `sudo chown` コマンドを実行することで、問題を解決できます。

Wiki pages you might want to explore:

- [Overview (regenrek/deepwiki-mcp)](https://deepwiki.com/regenrek/deepwiki-mcp/1-overview)